<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="FGLMtrunc">
<title>An introduction to `FGLMtrunc` • FGLMtrunc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An introduction to `FGLMtrunc`">
<meta property="og:description" content="FGLMtrunc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FGLMtrunc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/FGLMtrunc.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An introduction to `FGLMtrunc`</h1>
            
      
      
      <div class="d-none name"><code>FGLMtrunc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>FGLMtrunc</code> is a package that fits truncated Functional
Generalized Linear Models as described in <a href="https://doi.org/10.1016/j.csda.2022.107421" class="external-link">Liu, Divani, and
Petersen (2020)</a>. It implements methods for both functional linear
and functional logistic regression models. The solution path is computed
efficiently using active set algorithm with warm start. Optimal
smoothing and truncation parameters (<span class="math inline">\(\lambda_s, \lambda_t\)</span>) are chosen by
Bayesian information criterion (BIC).</p>
<p>To install <code>FGLMtrunc</code> directly from CRAN, type in R
console this command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"FGLMtrunc"</span><span class="op">)</span></code></pre></div>
<p>To load the <code>FGLMtrunc</code> package, type in R console:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FGLMtrunc</span><span class="op">)</span></code></pre></div>
<p>The function for fitting model is <code>fglm_trunc</code>, which have
arguments to customize the fit. Below are details on some required
arguments:</p>
<ul>
<li><p><code>X.curves</code> is required for matrix of functional
predictors.</p></li>
<li><p><code>Y</code> is required for response vector.</p></li>
<li><p>Either <code>nbasis</code> or <code>knots</code> is needed to
define the interior knots of B-spline.</p></li>
</ul>
<p>Please use <code><a href="../reference/fglm_trunc.html">?fglm_trunc</a></code> for more details on function
arguments. We will demonstrate usages of other commonly used arguments
by examples.</p>
</div>
<div class="section level2">
<h2 id="functional-linear-regression-familygaussian">Functional Linear Regression (<code>family="gaussian"</code>)<a class="anchor" aria-label="anchor" href="#functional-linear-regression-familygaussian"></a>
</h2>
<p>Functional linear regression model is the default choice of function
<code>fglm_trunc</code> with argument <code>family="gaussian"</code>.
For illustration, we use dataset <code>LinearExample</code>, which we
created beforehand following Case I in simulation studies section from
Liu et. al. (2020). This dataset contains <span class="math inline">\(n=200\)</span> observations, and functional
predictors are observed at <span class="math inline">\(p=101\)</span>
timepoints on <span class="math inline">\([0,1]\)</span> interval. The
true truncation point is <span class="math inline">\(\delta =
0.54\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LinearExample</span><span class="op">)</span>
<span class="va">Y_linear</span> <span class="op">=</span> <span class="va">LinearExample</span><span class="op">$</span><span class="va">Y</span>
<span class="va">Xcurves_linear</span> <span class="op">=</span> <span class="va">LinearExample</span><span class="op">$</span><span class="va">X.curves</span>
<span class="va">timeGrid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">timeGrid</span>, <span class="va">LinearExample</span><span class="op">$</span><span class="va">beta.true</span>, type <span class="op">=</span> <span class="st">'l'</span>, 
     main <span class="op">=</span> <span class="st">'True coefficient function'</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="FGLMtrunc_files/figure-html/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="fitting-fglmtrunc-model-for-linear-regression">Fitting <code>FGLMtrunc</code> model for linear regression<a class="anchor" aria-label="anchor" href="#fitting-fglmtrunc-model-for-linear-regression"></a>
</h3>
<p>We fit the model using 50 B-spline basis with default
<code>degree=3</code> for cubic splines. Since argument
<code>grid</code> is not specified, an equally spaced sequence of length
<span class="math inline">\(p=101\)</span> on <span class="math inline">\([0,1]\)</span> interval (including boundaries)
will automatically be used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/fglm_trunc.html">fglm_trunc</a></span><span class="op">(</span><span class="va">Y_linear</span>, <span class="va">Xcurves_linear</span>, nbasis <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p><code>fglm_trunc</code> also supports parallel computing to speed up
the running time of tuning regularization parameters. Parallel backend
must be registered before hand. Here is an example of using parallel
with <code>doMC</code> backend (we cannot run the code here since it is
not available for Windows) :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">doMC</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/doMC/man/registerDoMC.html" class="external-link">registerDoMC</a></span><span class="op">(</span>cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/fglm_trunc.html">fglm_trunc</a></span><span class="op">(</span><span class="va">Y_linear</span>, <span class="va">Xcurves_linear</span>, nbasis <span class="op">=</span> <span class="fl">50</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>One can also manually provides <code>grid</code> or
<code>knots</code> sequences (or both). If <code>knots</code> is
specified, <code>nbasis</code> will be ignored.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">-</span> <span class="fl">1</span> <span class="co">#Numbers of knots = nbasis - degree - 1</span>
<span class="va">knots_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">k</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">k</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="co"># Remove boundary knots</span>
<span class="va">fit2</span> <span class="op">=</span> <span class="fu"><a href="../reference/fglm_trunc.html">fglm_trunc</a></span><span class="op">(</span><span class="va">Y_linear</span>, <span class="va">Xcurves_linear</span>, grid <span class="op">=</span> <span class="va">timeGrid</span>, knots <span class="op">=</span> <span class="va">knots_n</span><span class="op">)</span></code></pre></div>
<p><code>fit</code> and <code>fit2</code> fitted models will have the
same results.</p>
<p><code>fit</code> is an object of class <code>FGLMtrunc</code> that
contains relevant estimation results. Please use
<code><a href="../reference/fglm_trunc.html">?fglm_trunc</a></code> for more details on function outputs. Function
call and truncation point will be printed with <code>print</code>
function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  fglm_trunc(Y = Y_linear, X.curves = Xcurves_linear, nbasis = 50) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimal truncation point: 0.52</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-with-fitted-fglmtrunc-model">Plotting with fitted <code>FGLMtrunc</code> model<a class="anchor" aria-label="anchor" href="#plotting-with-fitted-fglmtrunc-model"></a>
</h3>
<p>We can visualize the estimates of functional parameter <span class="math inline">\(\beta\)</span> directly with
<code>plot</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<p><img src="FGLMtrunc_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The plot shows both smoothing and truncated estimates of <span class="math inline">\(\beta\)</span>. We can set argument
<code>include_smooth=FALSE</code> to show only truncated estimate.</p>
</div>
<div class="section level3">
<h3 id="predicting-with-fitted-fglmtrunc-model">Predicting with fitted <code>FGLMtrunc</code> model<a class="anchor" aria-label="anchor" href="#predicting-with-fitted-fglmtrunc-model"></a>
</h3>
<p>Predict method for <code>FGLMtrunc</code> fits works similar to
<code>predict.glm</code>. Type <code>"link"</code> is the default choice
for <code>FGLMtrunc</code> object. For linear regression, both type
<code>"link"</code> and <code>"response"</code> return fitted values.
<code>newX.curves</code> is required for these predictions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, newX.curves <span class="op">=</span> <span class="va">Xcurves_linear</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;            [,1]</span>
<span class="co">#&gt; [1,]  2.1337413</span>
<span class="co">#&gt; [2,]  1.2286605</span>
<span class="co">#&gt; [3,]  1.8207552</span>
<span class="co">#&gt; [4,] -0.2430198</span>
<span class="co">#&gt; [5,]  0.5901628</span></code></pre></div>
<p>To get truncated estimate of <span class="math inline">\(\beta\)</span>, we can use either
<code>fit$beta.truncated</code> or <code>predict</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"coefficients"</span><span class="op">)</span>
<span class="co">#&gt;   [1] -1.194642e+00 -1.233189e+00 -1.274041e+00 -1.321971e+00 -1.382684e+00</span>
<span class="co">#&gt;   [6] -1.461724e+00 -1.560226e+00 -1.676778e+00 -1.806592e+00 -1.942359e+00</span>
<span class="co">#&gt;  [11] -2.075460e+00 -2.195993e+00 -2.293871e+00 -2.358836e+00 -2.381285e+00</span>
<span class="co">#&gt;  [16] -2.352969e+00 -2.266606e+00 -2.117256e+00 -1.901351e+00 -1.619372e+00</span>
<span class="co">#&gt;  [21] -1.273650e+00 -8.713600e-01 -4.219470e-01  6.139018e-02  5.633530e-01</span>
<span class="co">#&gt;  [26]  1.068248e+00  1.560120e+00  2.023704e+00  2.444542e+00  2.810437e+00</span>
<span class="co">#&gt;  [31]  3.112588e+00  3.344368e+00  3.503214e+00  3.588157e+00  3.601536e+00</span>
<span class="co">#&gt;  [36]  3.546803e+00  3.429575e+00  3.256279e+00  3.034685e+00  2.773190e+00</span>
<span class="co">#&gt;  [41]  2.481013e+00  2.167832e+00  1.843081e+00  1.516008e+00  1.196723e+00</span>
<span class="co">#&gt;  [46]  8.962979e-01  6.237543e-01  3.847519e-01  1.897238e-01  6.071026e-02</span>
<span class="co">#&gt;  [51]  8.314897e-03  1.796018e-06  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="co">#&gt;  [56]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="va">....</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="functional-logistic-regression-familybinomial">Functional Logistic Regression (<code>family="binomial"</code>)<a class="anchor" aria-label="anchor" href="#functional-logistic-regression-familybinomial"></a>
</h2>
<p>For logistic regression, we use dataset <code>LogisticExample</code>,
which is similar to <code>LinearExample</code>, but the response <span class="math inline">\(Y\)</span> was generated as Bernoulli random
variable.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LogisticExample</span><span class="op">)</span>
<span class="va">Y_logistic</span> <span class="op">=</span> <span class="va">LogisticExample</span><span class="op">$</span><span class="va">Y</span>
<span class="va">Xcurves_logistic</span> <span class="op">=</span> <span class="va">LogisticExample</span><span class="op">$</span><span class="va">X.curves</span></code></pre></div>
<div class="section level3">
<h3 id="fitting-fglmtrunc-model-for-logistic-regression">Fitting <code>FGLMtrunc</code> model for logistic regression<a class="anchor" aria-label="anchor" href="#fitting-fglmtrunc-model-for-logistic-regression"></a>
</h3>
<p>Similarly, we fit the model using 50 B-spline basis with default
choice of cubic splines. We need to set <code>family="binomial"</code>
for logistic regression. Printing and plotting are the same as
before.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit4</span> <span class="op">=</span> <span class="fu"><a href="../reference/fglm_trunc.html">fglm_trunc</a></span><span class="op">(</span><span class="va">Y_logistic</span>, <span class="va">Xcurves_logistic</span>, family<span class="op">=</span><span class="st">"binomial"</span>, nbasis <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  fglm_trunc(Y = Y_logistic, X.curves = Xcurves_logistic, family = "binomial", nbasis = 50) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimal truncation point: 0.58</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">)</span></code></pre></div>
<p><img src="FGLMtrunc_files/figure-html/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="predicting-with-fitted-fglmtrunc-model-for-logistic-regression">Predicting with fitted <code>FGLMtrunc</code> model for logistic
regression<a class="anchor" aria-label="anchor" href="#predicting-with-fitted-fglmtrunc-model-for-logistic-regression"></a>
</h3>
<p>For functional logistic regression, each <code>type</code> option
returns a different prediction:</p>
<ul>
<li><p><code>type="link"</code> gives the linear predictors which are
log-odds.</p></li>
<li><p><code>type="response"</code> gives the predicted
probabilities.</p></li>
<li><p><code>type="coefficients"</code> gives truncated estimate of
functional parameter <span class="math inline">\(\beta\)</span> as
before.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">logistic_link_pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit4</span>, newX.curves <span class="op">=</span> <span class="va">Xcurves_logistic</span>, type<span class="op">=</span><span class="st">"link"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">logistic_link_pred</span>, ylab<span class="op">=</span><span class="st">"log-odds"</span><span class="op">)</span></code></pre></div>
<p><img src="FGLMtrunc_files/figure-html/unnamed-chunk-15-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">logistic_response_pred</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit4</span>, newX.curves <span class="op">=</span> <span class="va">Xcurves_logistic</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">logistic_response_pred</span>, ylab<span class="op">=</span><span class="st">"predicted probabilities"</span><span class="op">)</span></code></pre></div>
<p><img src="FGLMtrunc_files/figure-html/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="functional-linear-regression-with-scalar-predictors">Functional Linear Regression with scalar predictors<a class="anchor" aria-label="anchor" href="#functional-linear-regression-with-scalar-predictors"></a>
</h2>
<div class="section level3">
<h3 id="fitting-fglmtrunc-model">Fitting <code>FGLMtrunc</code> model<a class="anchor" aria-label="anchor" href="#fitting-fglmtrunc-model"></a>
</h3>
<p><code>FGLMtrunc</code> allows using scalar predictors together with
functional predictors. First, we randomly generate observations for
scalar predictors:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scalar_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="co"># True coefficients for scalar predictors</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">400</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">200</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Randomly generated observations for scalar predictors. Binary coded as 0 and 1.</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span></code></pre></div>
<p>Next, we modify the response vector from <code>LinearExample</code>
so that it takes into account scalar predictors:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Y_scalar</span> <span class="op">&lt;-</span> <span class="va">Y_linear</span> <span class="op">+</span> <span class="op">(</span><span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">scalar_coef</span><span class="op">)</span></code></pre></div>
<p>Then we fit <code>FGLMtrunc</code> model with the matrix of scalar
predictors <code>S</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_scalar</span> <span class="op">=</span> <span class="fu"><a href="../reference/fglm_trunc.html">fglm_trunc</a></span><span class="op">(</span>X.curves<span class="op">=</span><span class="va">Xcurves_linear</span>, Y<span class="op">=</span><span class="va">Y_scalar</span>, S<span class="op">=</span><span class="va">S</span>, nbasis <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">fit_scalar</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  fglm_trunc(Y = Y_scalar, X.curves = Xcurves_linear, S = S, nbasis = 50) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Intercept      s1      s2     s3</span>
<span class="co">#&gt;     1.0865  1.0937 -1.0411 0.4233</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Optimal truncation point: 0.49</span></code></pre></div>
<p>Fitted coefficients for scalar predictors are close to the true
values.</p>
</div>
<div class="section level3">
<h3 id="predicting-with-scalar-predictors">Predicting with scalar predictors<a class="anchor" aria-label="anchor" href="#predicting-with-scalar-predictors"></a>
</h3>
<p>To make prediction with fitted model using scalar predictors, we need
to specified argument <code>newS</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_scalar</span>, newX.curves <span class="op">=</span> <span class="va">Xcurves_linear</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span>, newS<span class="op">=</span><span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;            [,1]</span>
<span class="co">#&gt; [1,]  0.3837103</span>
<span class="co">#&gt; [2,]  1.2553910</span>
<span class="co">#&gt; [3,]  3.2764746</span>
<span class="co">#&gt; [4,] -3.4882131</span>
<span class="co">#&gt; [5,]  0.7946992</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Xi Liu, Chau Tran, Alexander Petersen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
